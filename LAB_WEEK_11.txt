ASSIGNMENT ANSWERS – LAB WEEK 11 - Darryl Pratama Iswahyudhi (00000078651)

1.  Code that stores the picture in the path based on the given URI:
    (From ProviderFileManager → insertToStore) 
    
        private fun insertToStore(
        fileInfo: FileInfo,
        contentUri: Uri,
        contentValues: ContentValues
    ) {
        executor.execute {
            try {
                val insertedUri = contentResolver.insert(contentUri, contentValues)
                if (insertedUri != null) {
                    val inputStream = contentResolver.openInputStream(fileInfo.uri)
                    val outputStream = contentResolver.openOutputStream(insertedUri)

                    if (inputStream != null && outputStream != null) {
                        IOUtils.copy(inputStream, outputStream)
                    }

                    inputStream?.close()
                    outputStream?.close()
                }
            } catch (e: Exception) {
                e.printStackTrace()
            }
        }
    }

2.  Explanation of FileInfo attributes:

    -   Attribute 1: uri
        This URI refers to the temporary file location generated by
        FileProvider.
        It is the location where the camera app writes the captured
        image/video BEFORE it is copied into MediaStore.

    -   Attribute 4: relativePath
        This refers to the target folder inside MediaStore where the file
        should be stored.
        Example: “Pictures/” or “Movies/”.
        MediaStore will place the file in this directory in the
        user-accessible storage.

3. Chronological order when user takes a picture:

    1.  User taps the “Take Photo” button.
    2.  MainActivity calls checkStoragePermission().
    3.  If allowed, openImageCapture() is executed.
    4.  ProviderFileManager.generatePhotoUri() creates:
        -   A File
        -   A URI (via FileProvider)
        -   A FileInfo object
    5.  The URI is passed to TakePictureLauncher, which opens the camera.
    6.  Camera app writes the captured image to the temporary URI path.
    7.  When capture succeeds, insertImageToStore() is called.
    8.  This calls insertToStore(), which:
        a.  Inserts a new row into MediaStore using ContentValues.
        b.  Opens inputStream from the temporary URI.
        c.  Opens outputStream to the new MediaStore URI.
        d.  Copies the file using IOUtils.copy().
    9.  The picture becomes stored in MediaStore and accessible to gallery apps.
